@page "/createfile"
@rendermode InteractiveServer

<div class="ppt-container">
    <div class="ppt-header">
        <h3>PPT 生成助手</h3>
    </div>

    <div class="ppt-content">
        <div class="input-section">
            <div class="section-label">PPT 主题与内容</div>
            <textarea @bind="Ques"
                      placeholder="请描述您想要生成的PPT主题、内容和风格要求..."
                      class="text-area"
                      @bind:event="oninput"></textarea>
            
            <div class="ppt-options">
                <div class="option-group">
                    <div class="option-label">幻灯片数量</div>
                    <select class="option-select">
                        <option value="5">5 张</option>
                        <option value="10" selected>10 张</option>
                        <option value="15">15 张</option>
                        <option value="20">20 张</option>
                    </select>
                </div>
                
                <div class="option-group">
                    <div class="option-label">PPT 风格</div>
                    <select class="option-select">
                        <option value="business">商务风格</option>
                        <option value="creative">创意风格</option>
                        <option value="minimal" selected>简约风格</option>
                        <option value="academic">学术风格</option>
                    </select>
                </div>
            </div>
            
            <button class="generate-button" @onclick=ChooseLan>生成 PPT</button>
        </div>

        <div class="preview-section">
            <div class="section-label">预览</div>
            <div class="preview-content">
                <div class="placeholder-preview">
                    <div class="placeholder-icon">📊</div>
                    <p>PPT 生成后将在此处预览</p>
                    <p class="placeholder-hint">生成完成后，您可以下载 PPT 文件</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .ppt-container {
        display: flex;
        flex-direction: column;
        height: 100%;
        background-color: #f9f9f9;
        border-radius: 10px;
        overflow: hidden;
    }

    .ppt-header {
        padding: 15px 20px;
        background-color: white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .ppt-header h3 {
        margin: 0;
        color: #333;
    }

    .ppt-content {
        flex: 1;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    @@media (min-width: 768px) {
        .ppt-content {
            flex-direction: row;
        }
    }

    .input-section, .preview-section {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .section-label {
        font-weight: bold;
        font-size: 1.1rem;
        color: #333;
    }

    .text-area {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 5px;
        resize: vertical;
        min-height: 200px;
        font-family: inherit;
    }

    .ppt-options {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }

    .option-group {
        flex: 1;
        min-width: 150px;
    }

    .option-label {
        margin-bottom: 5px;
        font-size: 0.9rem;
        color: #555;
    }

    .option-select {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: white;
    }

    .generate-button {
        padding: 10px 20px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        align-self: flex-start;
        margin-top: 10px;
    }

    .generate-button:hover {
        background-color: #3d8b40;
    }

    .preview-content {
        background-color: white;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        min-height: 300px;
        display: flex;
        flex-direction: column;
        flex: 1;
    }

    .placeholder-preview {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100%;
        color: #999;
        text-align: center;
    }

    .placeholder-icon {
        font-size: 48px;
        margin-bottom: 15px;
    }

    .placeholder-hint {
        font-size: 0.9rem;
        margin-top: 10px;
        color: #aaa;
    }
</style>

@code {
    private string Ques = string.Empty;

    private void ChooseLan()
    {
        // 实现 PPT 生成逻辑
    }
}
